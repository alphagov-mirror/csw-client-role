{
    "version": 3,
    "terraform_version": "0.11.7",
    "serial": 3,
    "lineage": "8ce02303-e7dd-30e8-98dd-aaa8f505ef68",
    "modules": [
        {
            "path": [
                "root"
            ],
            "outputs": {},
            "resources": {},
            "depends_on": []
        },
        {
            "path": [
                "root",
                "csw_role"
            ],
            "outputs": {},
            "resources": {
                "data.template_file.policy": {
                    "type": "template_file",
                    "depends_on": [],
                    "primary": {
                        "id": "ffe874b1979b2a1400737cac266a85a2191f7246092e838881179e12c0adc6f9",
                        "attributes": {
                            "id": "ffe874b1979b2a1400737cac266a85a2191f7246092e838881179e12c0adc6f9",
                            "rendered": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"VisualEditor0\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"support:DescribeTrustedAdvisorCheckResult\",\n                \"support:DescribeTrustedAdvisorChecks\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"VisualEditor1\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:GetRole\",\n                \"iam:ListRoles\",\n                \"iam:GetRolePolicy\"\n            ],\n            \"Resource\": \"arn:aws:iam::779799343306:role/csw-dan_CstSecurityInspectorRole\"\n        },\n        {\n            \"Sid\": \"VisualEditor2\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:GetPolicy\",\n                \"iam:GetRolePolicy\",\n                \"iam:GetPolicyVersion\"\n            ],\n            \"Resource\": [\n                \"arn:aws:iam::779799343306:policy/csw-dan_CstSecurityInspectorRolePolicy\",\n                \"arn:aws:iam::779799343306:role/csw-dan_CstSecurityInspectorRole\"\n            ]\n        },\n        {\n            \"Sid\": \"VisualEditor3\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"configservice:DescribeComplianceByConfigRule\",\n                \"configservice:DescribeComplianceByResource\",\n                \"configservice:DescribeConfigRuleEvaluationStatus\",\n                \"configservice:DescribeConfigRules\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"VisualEditor4\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:ListGroups\",\n                \"iam:ListRoles\",\n                \"iam:ListUsers\",\n                \"iam:ListAttachedGroupPolicies\",\n                \"iam:ListAttachedRolePolicies\",\n                \"iam:ListAttachedUserPolicies\"\n            ],\n            \"Resource\": [\n                \"arn:aws:iam::779799343306:role/*\",\n                \"arn:aws:iam::779799343306:group/*\",\n                \"arn:aws:iam::779799343306:user/*\",\n                \"arn:aws:iam::779799343306:policy/*\"\n            ]\n        },\n        {\n            \"Sid\": \"VisualEditor4\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:DescribeSecurityGroups\"\n            ],\n            \"Resource\": [\n                \"arn:aws:ec2::779799343306:security-group/*\"\n            ]\n        }\n    ]\n}",
                            "template": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"VisualEditor0\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"support:DescribeTrustedAdvisorCheckResult\",\n                \"support:DescribeTrustedAdvisorChecks\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"VisualEditor1\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:GetRole\",\n                \"iam:ListRoles\",\n                \"iam:GetRolePolicy\"\n            ],\n            \"Resource\": \"arn:aws:iam::${account_id}:role/${prefix}_CstSecurityInspectorRole\"\n        },\n        {\n            \"Sid\": \"VisualEditor2\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:GetPolicy\",\n                \"iam:GetRolePolicy\",\n                \"iam:GetPolicyVersion\"\n            ],\n            \"Resource\": [\n                \"arn:aws:iam::${account_id}:policy/${prefix}_CstSecurityInspectorRolePolicy\",\n                \"arn:aws:iam::${account_id}:role/${prefix}_CstSecurityInspectorRole\"\n            ]\n        },\n        {\n            \"Sid\": \"VisualEditor3\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"configservice:DescribeComplianceByConfigRule\",\n                \"configservice:DescribeComplianceByResource\",\n                \"configservice:DescribeConfigRuleEvaluationStatus\",\n                \"configservice:DescribeConfigRules\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"VisualEditor4\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:ListGroups\",\n                \"iam:ListRoles\",\n                \"iam:ListUsers\",\n                \"iam:ListAttachedGroupPolicies\",\n                \"iam:ListAttachedRolePolicies\",\n                \"iam:ListAttachedUserPolicies\"\n            ],\n            \"Resource\": [\n                \"arn:aws:iam::${account_id}:role/*\",\n                \"arn:aws:iam::${account_id}:group/*\",\n                \"arn:aws:iam::${account_id}:user/*\",\n                \"arn:aws:iam::${account_id}:policy/*\"\n            ]\n        },\n        {\n            \"Sid\": \"VisualEditor4\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:DescribeSecurityGroups\"\n            ],\n            \"Resource\": [\n                \"arn:aws:ec2::${account_id}:security-group/*\"\n            ]\n        }\n    ]\n}",
                            "vars.%": "2",
                            "vars.account_id": "779799343306",
                            "vars.prefix": "csw-dan"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.template"
                },
                "data.template_file.trust": {
                    "type": "template_file",
                    "depends_on": [],
                    "primary": {
                        "id": "1807c1ed3fe1833c38c444f1e222846789c2e451cce55212e6852cc8a3e5b769",
                        "attributes": {
                            "id": "1807c1ed3fe1833c38c444f1e222846789c2e451cce55212e6852cc8a3e5b769",
                            "rendered": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"Statement0\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Resource\": [\n          \"arn:aws:lambda:eu-west-2:103495720024:function:csw-dan_audit_account_metric\"\n        ]\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}",
                            "template": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"Statement0\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Resource\": [\n          \"arn:aws:lambda:eu-west-2:103495720024:function:csw-dan_audit_account_metric\"\n        ]\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}",
                            "vars.%": "2",
                            "vars.account_id": "779799343306",
                            "vars.prefix": "csw-dan"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": "provider.template"
                }
            },
            "depends_on": []
        }
    ]
}
